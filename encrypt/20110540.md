# 20110540, Huỳnh Hùng Phú
# 4.1. Encrypt and Decrypt Text file 
<span style="color:blue">Create plain.txt </span>``` echo "My name is Phu" > plain.txt ```<br>
<span style="color:blue">View the plain.txt with xxd </span><br>
<img width="500" alt="411" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/441.png?raw=true"><br>


Mode aes-128-ecb, key: 20110540<br>
<span style="color:blue">Encrypt plain.txt with </span>``` openssl enc -aes-128-ecb -nosalt -in plain.txt -out ecb_encrypted_128.txt -K 20110540 ```<br> 
<span style="color:blue">View the ecb_encrypted_128.txt with xxd </span><br>
<img width="900" alt="446" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/446.png?raw=true"><br>
<span style="color:blue">Decrypt ecb_encrypted_128.txt with </span>``` openssl enc -d -aes-128-ecb -nosalt -in ecb_encrypted_128.txt -out ecb_decrypted_128.txt -K 20110540 ```<br> 
<span style="color:blue">View the ecb_decrypted_128.txt with xxd </span><br>
<img width="900" alt="447" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/447.png?raw=true"><br>

Mode aes-256-ecb, key: 20110540<br>
<span style="color:blue">Encrypt plain.txt with </span>``` openssl enc -aes-256-ecb -nosalt -in plain.txt -out ecb_encrypted.txt -K 20110540 ```<br> 
<span style="color:blue">View the ecb_encrypted.txt with xxd </span><br>
<img width="900" alt="442" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/442.png?raw=true"><br>
<span style="color:blue">Decrypt ecb_encrypted.txt with </span>``` openssl enc -d -aes-256-ecb -nosalt -in ecb_encrypted.txt -out ecb_decrypted.txt -K 20110540 ```<br> 
<span style="color:blue">View the ecb_decrypted.txt with xxd </span><br>
<img width="900" alt="443" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/443.png?raw=true"><br>

Mode aes-128-cbc, key: 20110540, initialization vector: 0102030405060708090A0B0C0D0E0F10<br>
<span style="color:blue">Encrypt plain.txt with </span>``` openssl enc -aes-128-cbc -nosalt -in plain.txt -out cbc_encrypted_128.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">View the cbc_encrypted_128.txt with xxd </span><br>
<img width="900" alt="448" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/448.png?raw=true"><br>
<span style="color:blue">Decrypt cbc_encrypted_128.txt with </span>``` openssl enc -d -aes-128-cbc -nosalt -in cbc_encrypted_128.txt -out cbc_decrypted_128.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">View the cbc_decrypted_128.txt with xxd </span><br>
<img width="900" alt="449" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/449.png?raw=true"><br>

Mode aes-256-cbc, key: 20110540, initialization vector: 0102030405060708090A0B0C0D0E0F10<br>
<span style="color:blue">Encrypt plain.txt with </span>``` openssl enc -aes-256-cbc -nosalt -in plain.txt -out cbc_encrypted.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">View the cbc_encrypted.txt with xxd </span><br>
<img width="900" alt="444" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/444.png?raw=true"><br>
<span style="color:blue">Decrypt cbc_encrypted.txt with </span>``` openssl enc -d -aes-256-cbc -nosalt -in cbc_encrypted.txt -out cbc_decrypted.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">View the ecb_decrypted.txt with xxd </span><br>
<img width="900" alt="445" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/445.png?raw=true"><br>

# 4.2 Encryption Mode – ECB vs. CBC 
<span style="color:blue">Extract the header </span>``` dd if=whale1.bmp of=header.bin bs=1 count=54 ```<br> 
<span style="color:blue">Extract the body </span>``` dd if=whale1.bmp of=body.bin bs=1 skip=54 ```<br> 
<span style="color:blue">Encrypt the body </span>``` openssl enc -aes-256-cbc -nosalt -in body.bin -out encrypted_body.bin -K 00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">Combine the header and the encrypted </span>``` cat header.bin encrypted_body.bin > partially_encrypted.bmp ```<br> 
<img width="900" alt="421" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/421.png?raw=true"><br>
<span style="color:blue">Encrypted images are just tiny dots, with no discernible shapes visible in the picture</span><br> 
<img width="700" alt="422" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/422.png?raw=true"><br>

# 4.3 Encryption Mode – Corrupted Cipher Text 
<span style="color:blue">Create a text file </span> ``` echo "Image upload function can be used to upload arbitrary and potentially dangerous files" > textfile.txt ```<br>

Mode aes-256-ecb<br>
<span style="color:blue">Encrypt textfile.txt with </span>``` openssl enc -aes-256-ecb -nosalt -in textfile.txt -out ecb_encrypted_textfile.txt -K 20110540 ```<br> 
<span style="color:blue">Copies the contents of ecb_encrypted_textfile.txt into corrupted_encrypted_textfile.txt </span>``` cat ecb_encrypted_textfile.txt > corrupted_encrypted_textfile.txt ```<br> 
<span style="color:blue">Corrupt the byte using dd </span> ``` dd if=/dev/urandom of=corrupted_encrypted_textfile.txt bs=1 count=1 seek=4 conv=notrunc ``` <br>
<span style="color:blue">Decrypt corrupted_encrypted_textfile.txt with </span>``` openssl enc -d -aes-256-ecb -nosalt -in corrupted_encrypted_textfile.txt -out corrupted_decrypted_textfile.txt -K 20110540 ```<br> 
<img width="700" alt="433" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/433.png?raw=true"><br>

Mode aes-256-cbc<br>
<span style="color:blue">Encrypt textfile.txt with </span>``` openssl enc -aes-256-cbc -nosalt -in textfile.txt -out cbc_encrypted_textfile.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<span style="color:blue">Copies the contents of cbc_encrypted_textfile.txt into corrupted_cbc_encrypted_textfile.txt </span>``` cat cbc_encrypted_textfile.txt > corrupted_cbc_encrypted_textfile.txt ```<br> 
<span style="color:blue">Corrupt the byte using dd </span> ``` dd if=/dev/urandom of=corrupted_cbc_encrypted_textfile.txt bs=1 count=1 seek=4 conv=notrunc ``` <br>
<span style="color:blue">Decrypt cbc_encrypted.txt with </span>``` openssl enc -d -aes-256-cbc -nosalt -in corrupted_cbc_encrypted_textfile.txt -out corrupted_cbc_decrypted.txt -K 20110540 -iv 0102030405060708090A0B0C0D0E0F10 ```<br> 
<img width="900" alt="434" src="https://github.com/hungphu2151/security_labs/blob/main/encrypt/images/434.png?raw=true"><br>

Answer:<br>
<span style="color:blue">In ECB mode, it can be guessed that the data is recoverable after the corrupted bit </span><br>
<span style="color:blue">In CBC mode, data isn't recoverable </span>
<span style="color:blue">In ECB mode, Each block is encrypted independently. If a single bit is corrupted, only the corresponding block is affected. The subsequent blocks remain intact and can be decrypted correctly. </span><br>
<span style="color:blue">In CBC mode, Each block is XORed with the previous ciphertext block before being encrypted. A single bit corruption in the ciphertext will affect the decryption of the current block and the following block, making recovery of data after the corrupted bit impossible.</span>
